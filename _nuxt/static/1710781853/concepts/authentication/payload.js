__NUXT_JSONP__("/concepts/authentication", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_){return {data:[{document:{slug:"authentication",description:"An opinionated framework for building APIs in Ruby.",title:"Authentication",position:1.2,category:"Concepts",toc:[{id:v,depth:w,text:x},{id:y,depth:w,text:z}],body:{type:"root",children:[{type:b,tag:m,props:{},children:[{type:a,value:"Apia provides a framework for handling authentication through "},{type:b,tag:"em",props:{},children:[{type:a,value:"Authenticators"}]},{type:a,value:". An authenticator is similar in so much as it allows you to define a block of code to excute before each endpoint."}]},{type:a,value:e},{type:b,tag:m,props:{},children:[{type:a,value:"Authenticators can apply to the whole API, to all endpoints in a controller or just to a specific endpoint."}]},{type:a,value:e},{type:b,tag:A,props:{id:v},children:[{type:b,tag:B,props:{ariaHidden:C,href:"#creating-an-authenticator",tabIndex:D},children:[{type:b,tag:c,props:{className:[E,F]},children:[]}]},{type:a,value:x}]},{type:a,value:e},{type:b,tag:m,props:{},children:[{type:a,value:"Begin by creating your authenticator. Below shows a simple example:"}]},{type:a,value:e},{type:b,tag:G,props:{className:[H]},children:[{type:b,tag:I,props:{className:[J,K]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:L}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:M}]},{type:a,value:N},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:O}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,P]},children:[{type:a,value:s}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:Q}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:R}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:s}]},{type:a,value:"\n\n    name "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"'Main authenticator'"}]},{type:a,value:"\n    description "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"'Allows authentication using an API token provided in an Authorization header'"}]},{type:a,value:"\n\n    type "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:S}]},{type:a,value:"\n\n    potential_error "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:T}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"do"}]},{type:a,value:"\n      code "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:":invalid_api_token"}]},{type:a,value:"\n      description "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"'The API token provided in the Authorization header was not valid'"}]},{type:a,value:"\n      http_status "},{type:b,tag:c,props:{className:[d,"number"]},children:[{type:a,value:"403"}]},{type:a,value:"\n      field "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:":given_token"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:t}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:":string"}]},{type:a,value:"\n    "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"def"}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,"method-definition"]},children:[{type:b,tag:c,props:{className:[d,"function"]},children:[{type:a,value:V}]}]},{type:a,value:"\n      given_token_string "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:u}]},{type:a,value:" request"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:p}]},{type:a,value:"headers"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:"["}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"'Authorization'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:"]"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:p}]},{type:a,value:"sub"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,"regex"]},children:[{type:a,value:"\u002F\\ABearer \u002F"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:t}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"''"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:"\n      token "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:u}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"APIToken"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:p}]},{type:a,value:"authenticate"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:"given_token_string"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:"\n      "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"if"}]},{type:a,value:" token"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"nil"}]},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:"?"}]},{type:a,value:"\n        raise_error "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:t}]},{type:a,value:" given_token"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:o}]},{type:a,value:" given_token_string\n      "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:l}]},{type:a,value:"\n\n      request"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:p}]},{type:a,value:"identity "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:u}]},{type:a,value:" token\n    "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:l}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:l}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:l}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:m,props:{},children:[{type:a,value:"Let's take a look through this line by line:"}]},{type:a,value:e},{type:b,tag:"ul",props:{},children:[{type:a,value:e},{type:b,tag:r,props:{},children:[{type:a,value:"Firstly, we define the name & description for the authenticator. This is used for documentation."}]},{type:a,value:e},{type:b,tag:r,props:{},children:[{type:a,value:"Next, we choose the type of authenticator. Apia only currently supports "},{type:b,tag:j,props:{},children:[{type:a,value:S}]},{type:a,value:". This is only used for documentation purposes as well."}]},{type:a,value:e},{type:b,tag:r,props:{},children:[{type:a,value:"Then, we define a potential error that this authenticator might raise. In this case, the API token provided may be invalid and we'll raise that error."}]},{type:a,value:e},{type:b,tag:r,props:{},children:[{type:a,value:"Finally, we define the "},{type:b,tag:j,props:{},children:[{type:a,value:V}]},{type:a,value:" method which will be invoked when the authenticator is used. This is responsible for setting the "},{type:b,tag:j,props:{},children:[{type:a,value:Z}]},{type:a,value:" property or raising an error if authentication has failed. You don't "},{type:b,tag:"strong",props:{},children:[{type:a,value:"have"}]},{type:a,value:" to set a "},{type:b,tag:j,props:{},children:[{type:a,value:Z}]},{type:a,value:" if you don't wish (anonymous access?) but unless you raise an error in here the endpoint execution will continue."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:A,props:{id:y},children:[{type:b,tag:B,props:{ariaHidden:C,href:"#applying-to-the-api",tabIndex:D},children:[{type:b,tag:c,props:{className:[E,F]},children:[]}]},{type:a,value:z}]},{type:a,value:e},{type:b,tag:m,props:{},children:[{type:a,value:"You most likely will want to make this authenticator apply to everything in the API. To do this, you need to reference it in your API:"}]},{type:a,value:e},{type:b,tag:G,props:{className:[H]},children:[{type:b,tag:I,props:{className:[J,K]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:L}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:M}]},{type:a,value:N},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:O}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,P]},children:[{type:a,value:"Base"}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:Q}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:R}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"API"}]},{type:a,value:"\n\n    authenticator "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:s}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,"comment"]},children:[{type:a,value:"# ... routes, scopes etc..."}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:l}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:l}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:m,props:{},children:[{type:a,value:"Additionally, you can use different authenticators for different endpoints by definining an "},{type:b,tag:j,props:{},children:[{type:a,value:"authenticator"}]},{type:a,value:" for any controller (to apply for all endpoints in the controller) or on the endpoint itself."}]}]},dir:"\u002Fen\u002Fconcepts",path:"\u002Fen\u002Fconcepts\u002Fauthentication",extension:".md",createdAt:_,updatedAt:_,to:"\u002Fconcepts\u002Fauthentication"},prev:{title:"Generating docs",path:"\u002Fen\u002Fdocumentation",to:"\u002Fdocumentation"},next:{title:"Endpoints",path:"\u002Fen\u002Fconcepts\u002Fendpoints",to:"\u002Fconcepts\u002Fendpoints"}}],fetch:{},mutations:[]}}("text","element","span","token","\n","punctuation","keyword"," ","constant","code","string","end","p","operator",":",".","symbol","li","Authenticator",",","=","creating-an-authenticator",2,"Creating an authenticator","applying-to-the-api","Applying to the API","h2","a","true",-1,"icon","icon-link","div","nuxt-content-highlight","pre","language-ruby","line-numbers","module","CoreAPI","\n  ","class","class-name","\u003C","Apia",":bearer","'InvalidAPIToken'","\n\n    ","call","(",")","\n\n  ","request.identity","2024-03-18T17:10:17.939Z")));